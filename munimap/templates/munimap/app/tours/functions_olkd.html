<script type="text/javascript">
    var steps = [{
      orphan: true,
      content: '<center>Der <span style="color:rgb(227,0,20);">onlineKARTENdienst</span> liefert Grundstücks- und Eigentümerdaten sowie Fachinformationen ' +
                'für berechtigte Personen. Zusammen mit komfortablen Such- und amtlichen Auskunftsmöglichkeiten, intuitiver Bedienung und einem flexiblen ' + 
                'Design, unterstützt er die räumliche Einordnung und Entscheidungsfindung innerhalb der Stadt Bielefeld.<br><br>' +
                'Im Folgenden erhalten Sie einen kurzen Überblick über die Funktionen. Diese Hilfe ist jederzeit über die Werkzeuge aufrufbar.<br><br>' +
                'Bei Fragen, Anmerkungen oder Problemen wenden Sie sich gerne jederzeit <a href="mailto:olkd@bielefeld.de">per Mail</a> an uns.</center>'
    },
    {
        element: '.anol-searchbox',
        title: 'Die Suche / Navigation in der Karte',
        placement: 'bottom',
        content: '<strong>Adresse:</strong>' +
                 '<p>Die Suche unterstützt Autovervollständigung! Schreibfehler werden ignoriert:' + 
                 '<br>- <i>bebel 92</i> findet <i>August-Bebel-Straße 92</i></p>' +
                 '<strong>Koordinaten:</strong>' +
                 '<p>- ETRS89 / UTM: <i>470500 5765000</i>' +
                 '<br>- WGS84: <i>52.021162 8.535049</i></p>' +
                 '<strong>Flurstückskennzeichen:</strong>' +
                 '<p>- <i>Altenhagen 4 632</i> | <i>2851 4 632</i></p>' +
                 '<strong>Point of Interest (POI):</strong>' +
                 '<p>- <i>Schüco-Arena</i> | <i>Viadukt</i> | <i>Bosseschule</i></p>'
    },{
        element: '.anol-searchbox',
        title: 'Die Suche / Navigation in der Karte',
        placement: 'bottom',
        content: '<strong>Schlüsselwort-Suche:</strong>' +
                 '<p>Über die Schlüsselwort-Suche kann explizit in ausgewählten Themen gesucht werden.</p>' +
                 '<strong>Bebauungsplan:</strong>' +
                 '<p>- <i><strong>BPlan</strong> II/J11</i> | <i><strong>BPlan</strong> Meyerfeld</i></p>' +
                 '<strong>Vermessungspunkte:</strong>' +
                 '<p>- <i><strong>VP</strong> 324675763404000</i> | <i><strong>VP</strong> 32467 5763 404000</i></p>' +
                 '<strong>Grünflächen:</strong>' +
                 '<p>- <i><strong>GFL</strong> 11 007</i> | <i><strong>GFL</strong> Wertherstr</i></p>'
    },{
        element: '.btn.geocoder-list',
        title: 'Die Suche / Navigation in der Karte',
        placement: 'bottom',
        content: '<strong>Katalog-Suche:</strong>' +
                 '<p>Die Katalog-Suche leitet Sie Schritt für Schritt zum Suchergebnis.</p>' + 
                 '<u>Adress-Katalog:</u>' +
                 '<p>- Auswahl Anfangsbuchstabe der Straße<br>' +
                 '- Auswahl der Straße<br>' +
                 '&rarr; Anzeige aller Hausnummern</p>' +
                 '<u>Flurstücks-Katalog:</u>' +
                 '<p>- Auswahl der Gemarkung<br>' +
                 '- Auswahl der Flur<br>' +
                 '&rarr; Anzeige aller Flurstücksnummern</p>' +
                 '<strong>Themen-Suche:</strong>' +
                 '<p>Themen können eine eigene Suche haben, um speziell nach Objekten des ausgewählten Themas zu suchen (z.B. Baulasten, PLZ).</p>'
    }, {
        element: '.menu-control',
        title: 'Menü öffnen / schließen',
        content: '<img width="20" src="{$ url_for("static", filename="img/tours/menu.png") $}" />' +
                 '<p>Hier können Hintergrundkarten und darzustellende Themen ausgewählt und hinzugeladen werden. ' +
                 'Sie können den Maßstab einstellen, die Legende einsehen und die Druckfunktionen verwenden.</p>'
    }, {
        element: '.ol-zoom',
        title: 'Kartenfunktionen',
        content: '<img width="20" src="{$ url_for("static", filename="img/tours/zoom-in.png") $}" /> Karte vergrößern<br>' +
                 '<img width="20" src="{$ url_for("static", filename="img/tours/zoom-out.png") $}" /> Karte verkleinern<br>' +
                 '<img width="20" src="{$ url_for("static", filename="img/tours/geolocate.png") $}" /> Positionsbestimmung (mobil muss GPS aktiv sein)<br>' +
                 '<img width="20" src="{$ url_for("static", filename="img/tours/home.png") $}" /> Zurück zur Ausgangsposition<br>' + 
                 '<div><strong>Tipp:</strong> Rechteckzoom/ Lupe &rarr; SHIFT-Taste halten und mit linker Maustaste ein Rechteck aufziehen</div>'
    }, {
        element: '.tools-control',
        title: 'Werkzeuge',
        content: '<img width="20" src="{$ url_for("static", filename="img/tours/tools.png") $}" /><br>' +
                 '<strong>Koordinaten ermitteln:</strong>' +
                 '<p>- Punkt durch Klick in die Karte bestimmen<br>- Koordinatensystem wählen<br>- Koordinaten können kopiert werden</p>' +
                 '<strong>Strecke / Fläche messen:</strong>' +
                 '<p>- Strecken- / Flächenpunkte markieren<br>- Punkte können nachträglich verschoben und eingefügt werden</p>' +
                 '<strong>Einstellungen / WMC speichern</strong>' +
                 '<p>- Abspeichern der aktuellen Kartenkonfiguration (Hintergrundkarte, Themen etc.)</p>' +
                 '<strong>Einstellungen / WMC laden</strong>' +
                 '<p>- Laden einer von Ihnen erstellten Kartenkonfiguration</p>' +
                 '<strong>Passwort ändern</strong>' +
                 '<p>- Änderung Ihres Passwortes</p>' +
                 '<strong>Hilfe starten</strong>' +
                 '<p>- Funktionserklärung starten</p>'
    }, {
        element: '.alkis-control',
        title: 'ALKIS-Werkzeuge',
        content: '<img width="20" src="{$ url_for("static", filename="img/tours/alkis.png") $}" />' +
                 '<p>Die Ihnen zur Verfügung stehenden Funktionen sind abhängig von Ihren Berechtigungen.</p>' +
                 '<strong>Auskunft:</strong>' +
                 '<p>- Flurstücks- und Eigentümerangaben anzeigen</p>' +
                 '<strong>Selektion:</strong>' +
                 '<p>- Flurstücke über Flurstücksangaben, Adresse oder Eigentümerangaben suchen</p>' +
                 '<strong>PDF:</strong>' +
                 '<p>- nicht amtliche Auskünfte im PDF-Format</p>' +
                 '<strong>Amtlich:</strong>' +
                 '<p>- amtliche Auskünfte im PDF-Format</p>'
    }, {
        element: 'div[sidebar-item="background"] .panel-heading',
        title: 'Hintergrundkarten',
        content: '<p>Wählen Sie hier eine Hintergrundkarte aus, auf der die Themen und Inhalte angezeigt werden. ' +
                 'Optional besteht die Möglichkeit <i>Keine Hintergrundkarte</i> auszuwählen.</p>',
        onShow: function() {
            var sidebarScope = angular.element('.side-bar').scope();
            var backgroundItemScope = angular.element('div[sidebar-item="background"] .panel-heading').scope();
            sidebarScope.$apply(function() {
                sidebarScope.sidebar.open = true;
                backgroundItemScope.open();
            });
        },
        onHide: function() {
            var sidebarScope = angular.element('.side-bar').scope();
            var backgroundItemScope = angular.element('div[sidebar-item="background"] .panel-heading').scope();
            backgroundItemScope.$apply(function() {
                sidebarScope.sidebar.open = false;
                backgroundItemScope.close();
            });
        }

    }, {
        element: 'div[sidebar-item="overlay"] .panel-heading',
        title: 'Themen | Inhalte',
        content: '<p>Themenbezeichnung anklicken &rarr; Das Thema wird ein- bzw. ausgeblendet</p>' +
                 '<p><span class="glyphicon glyphicon-menu-right"></span> anklicken &rarr; Themengruppe wird ausgeklappt, nun können einzelne Layer ein- bzw. ausgeblendet werden</p>' +
                 '<p><span class="glyphicon glyphicon-info-sign"></span> anklicken &rarr; Öffnet Metadaten zum Thema</p>' +
                 '<p><span class="glyphicon glyphicon-remove"></span> anklicken &rarr; Das Thema oder den Layer aus der Ansicht entfernen</p>' +
                 '<p>Per Drag´n´Drop kann die Reihenfolge der Layer angepasst werden</p>' +
                 '<p>Themen hinzuladen &rarr; Öffnet die Auswahl Ihrer zur Verfügung stehenden Themen, um diese der Ansicht hinzuzufügen</p>',
        onShow: function() {
            var sidebarScope = angular.element('.side-bar').scope();
            var overlayItemScope = angular.element('div[sidebar-item="overlay"] .panel-heading').scope();
            overlayItemScope.$apply(function() {
                sidebarScope.sidebar.open = true;
                overlayItemScope.open();
            });
        },
        onHide: function() {
            var sidebarScope = angular.element('.side-bar').scope();
            var overlayItemScope = angular.element('div[sidebar-item="overlay"] .panel-heading').scope();
            overlayItemScope.$apply(function() {
                sidebarScope.sidebar.open = false;
                overlayItemScope.close();
            });
        }
    }, {
        element: 'div[sidebar-item="legend"] .panel-heading',
        title: 'Legende',
        content: '<p>Öffnet die Zeichenerklärung der aktiven Hintergrundkarten sowie Themen und Inhalte</p>',
        onShow: function() {
            var sidebarScope = angular.element('.side-bar').scope();
            var printItemScope = angular.element('div[sidebar-item="legend"] .panel-heading').scope();
            printItemScope.$apply(function() {
                sidebarScope.sidebar.open = true;
                printItemScope.open();
            });
        },
        onHide: function() {
            var sidebarScope = angular.element('.side-bar').scope();
            var printItemScope = angular.element('div[sidebar-item="legend"] .panel-heading').scope();
            printItemScope.$apply(function() {
                sidebarScope.sidebar.open = false;
                printItemScope.close();
            });
        }
    }, {
        element: 'div[sidebar-item="print"] .panel-heading',
        title: 'Drucken | PDF',
        content: '<ol style="margin-left: 17px">' +
                 '  <li>Seitengröße einstellen' +
                 '    <ul style="margin-left: 25px"><li>Über Seitengröße kann ein vordefiniertes DIN-Format ausgewählt werden</li>' +
                 '    <li>Über Breite und Höhe kann ein individuelles Format eingestellt werden</li></ul></li>' +
                 '    <div><strong>Tipp:</strong> Der im Kartenbild angezeigte gewählte Druckbereich kann per Drag´n´Drop verschoben werden</div>' +
                 '  <li>Maßstab wählen</li>' +
                 '  <li>Ausgabeformat wählen</li>' +
                 '  <li><i>Straßenverzeichnis erzeugen</i> aktivieren (optional)</li>' +
                 '  <li>Karte ausgeben</li>' +
                 '  <li>Warten bis der Exportvorgang abgeschlossen ist und dann das Dokument herunterladen</li>' +
                 '</ol>',
        onShow: function() {
            var sidebarScope = angular.element('.side-bar').scope();
            var printItemScope = angular.element('div[sidebar-item="print"] .panel-heading').scope();
            printItemScope.$apply(function() {
                sidebarScope.sidebar.open = true;
                printItemScope.open();
            });
        },
        onHide: function() {
            var sidebarScope = angular.element('.side-bar').scope();
            var printItemScope = angular.element('div[sidebar-item="print"] .panel-heading').scope();
            printItemScope.$apply(function() {
                sidebarScope.sidebar.open = false;
                printItemScope.close();
            });
        }
    }, {
        element: '.anol-attribution',
        title: 'Quellenangaben',
        content: '<img width="20" src="{$ url_for("static", filename="img/tours/attribution.png") $}" /><br>' +
                 ' <p>Es werden die Urheberrechte der aktiven Hintergrundkarten sowie Themen und Inhalte angezeigt.</p>',
        placement: 'left',
        onShown: function() {
            document.querySelector('.popover.tour').style.bottom = "2px";
        }
    }, {
      orphan: true,
      title: 'Kontext-Info',
      content: '<center>Per Rechts-Klick in die Karte öffnet sich ein Kontext-Menü, über das Sie <strong>an dieser Position</strong> das <strong>3D-Stadtmodell</strong>, ' +
                'die <strong>Schrägluftbilder</strong>, <strong>OpenStreetMap</strong> oder <strong>Google Maps</strong> aufrufen können.</center>'
    }];
    var tour = new Tour({
        template: function(i) {
            var tmpl =  '<div class="popover tour">' +
                        '  <div class="arrow"></div>' +
                        '  <div class="tour-content">' +
                        '    <div class="tour-head">';
            if(i > 0) {
                tmpl += '     <span class="pull-left">' + i + ' / ' + (steps.length - 1) + '</span>';
            }
            tmpl += '         <span class="pull-right pointer" data-role="end">' +
                    '            Fenster schließen <i class="glyphicon glyphicon-remove"></i>' +
                    '          </span>' +
                    '        </div>' +
                    '        <img class="tour-image" src="{$ url_for("static", filename="img/tours/onlinekartendienst.png") $}" />' +
                    '        <h4 class="popover-title"></h4>' +
                    '        <div class="popover-content"></div>';
            if(i === 0) {
                tmpl += '   <button class="btn btn-default start-tour" data-role="next">Funktionserklärung starten</button>';
            } else if (i === steps.length - 1) {
                tmpl += '   <div class="popover-navigation">' +
                        '     <span data-role="prev" class="pull-left pointer"><i class="glyphicon glyphicon-chevron-left"></i> vorhergehender Tipp</span>' +
                        '   </div>';
            } else {
                tmpl += '   <div class="popover-navigation">' +
                        '     <span data-role="prev" class="pull-left pointer"><i class="glyphicon glyphicon-chevron-left"></i> vorhergehender Tipp</span>' +
                        '     <span data-role="next" class="pull-right pointer">nächster Tipp <i class="glyphicon glyphicon-chevron-right"></i></span>' +
                        '   </div>';
            }
            tmpl += '     </div>' +
                    '   </div>';
            return tmpl;
        },
        steps: steps
    });
    angular.module('munimap')
    .value('Tour', tour);
</script>
