services:
  tms:
  wmts:
  wms:
    srs: ['EPSG:3857', 'EPSG:4326', 'EPSG:25832']
    max_output_pixels: [14000, 14000]
    md:
      title: Bielefeld MapProxy
      abstract: Mapproxy for Bielefeld
  demo:


layers:
  - name: stadtplan_bi
    title: OSM+ALKIS Bielefeld
    sources: [stadtplan_bi_utm32_cache]
    tile_sources: [stadtplan_bi_utm32_adv_cache, stadtplan_bi_utm32_adv_hq_cache]


  - name: stadtplan_bi_direct
    title: OSM+ALKIS Bielefeld f√ºr den Druck
    sources: [stadtplan_bi_source]

  - name: nw_dop40
    title: NRW DOP 40
    sources: [nw_dop40_cache]

caches:
  stadtplan_bi_webmerc_cache:
    grids: [webmercator]
    sources: [stadtplan_bi_source]
    cache:
      type: file
      directory_layout: mp

  stadtplan_bi_utm32_cache:
    grids: [ utm32 ]
    sources: [ stadtplan_bi_source ]
    cache:
      type: file
      directory_layout: mp

  stadtplan_bi_utm32_adv_cache:
    grids: [ utm32_adv ]
    sources: [ stadtplan_bi_utm32_cache ]
    meta_size: [ 1, 1 ]
    meta_buffer: 0
    disable_storage: true

  stadtplan_bi_utm32_adv_hq_cache:
    grids: [ utm32_adv_hq ]
    sources: [ stadtplan_bi_hq_source ]

  nw_dop40_cache:
    request_format: image/png
    format: mixed
    grids: [ utm32 ]
    sources: [ nw_dop40 ]
    cache:
      type: file
      directory_layout: mp

sources:
  nw_dop40:
    type: wms
    req:
      url: http://www.wms.nrw.de/geobasis/wms_nw_dop40?
      layers: nw_dop40
      transparent: true

  stadtplan_bi_source:
    type: wms
    forward_req_params:
      - map_resolution
    req:
      url: http://munimap-mapserver?map=/opt/etc/styles/bielefeld/map/bielefeld.map
      layers: map
      transparent: false
    coverage:
      bbox: [-46133.17, 5048875.26857567, 1206211.10142433, 6301219.54]
      srs: 'EPSG:25832'

  stadtplan_bi_hq_source:
    type: wms
    req:
      url: http://munimap-mapserver?map=/opt/etc/styles/bielefeld/map/bielefeld.map
      layers: map
      transparent: false
      map_resolution: 144
    coverage:
      bbox: [-46133.17, 5048875.26857567, 1206211.10142433, 6301219.54]
      srs: 'EPSG:25832'

grids:
  utm32_adv:
    bbox: [-46133.17, 5048875.26857567, 1206211.10142433, 6301219.54]
    srs: 'EPSG:25832'
    origin: ul
    res:
      - 4891.96981025128       # 0
      - 2445.98490512564       # 1
      - 1222.99245256282       # 2
      - 611.496226281410       # 3
      - 305.748113140705       # 4
      - 152.874056570353       # 5
      - 76.4370282851763       # 6
      - 38.2185141425881       # 7
      - 19.1092570712941       # 8
      - 9.55462853564703       # 9
      - 4.77731426782352       # 10
      - 2.38865713391176       # 11
      - 1.19432856695588       # 12
      - 0.597164283477939      # 13
      - 0.298582141738970      # 14
      - 0.14929107086948457   ## 15 nicht offiziell
      - 0.074645535434742285   ## 16 test tesch
      - 0.0373227677173711425   ## 17 test tesch
      - 0.01866138385868557125   ## 18 test tesch
      - 0.009330691929342785625   ## 19 test tesch

  utm32_adv_hq:
    bbox: [-46133.17, 5048875.26857567, 1206211.10142433, 6301219.54]
    srs: 'EPSG:25832'
    origin: ul
    tile_size: [512, 512]
    res:
      - 2445.98490512564
      - 1222.99245256282
      - 611.496226281410
      - 305.748113140705
      - 152.874056570353
      - 76.4370282851763
      - 38.2185141425881
      - 19.1092570712941
      - 9.55462853564703
      - 4.77731426782352
      - 2.38865713391176
      - 1.19432856695588
      - 0.597164283477939
      - 0.298582141738970
      - 0.14929107086948457   # nicht offiziell
      - 0.07464553543474228   #
      - 0.0373227677173711425   ## test tesch
      - 0.01866138385868557125   ## test tesch
      - 0.009330691929342785625   ##  test tesch
      - 0.0046653459646713928125 ## test tesch

  utm32:
    bbox: [-46133.17, 5048875.26857567, 1206211.10142433, 6301219.54]
    srs: 'EPSG:25832'
    origin: ul
    res:
      - 4891.96981025128      # 0
      - 3459.1450261885484    # 1
      - 2445.9849051256397    # 2
      - 1729.5725130942737    # 3
      - 1222.9924525628198    # 4
      - 864.7862565471368     # 5
      - 611.4962262814098     # 6
      - 432.3931282735683     # 7
      - 305.7481131407049     # 8
      - 216.19656413678416    # 9
      - 152.8740565703524     # 10
      - 108.09828206839207    # 11
      - 76.43702828517618     # 12
      - 54.049141034196026    # 13
      - 38.21851414258809     # 14
      - 27.024570517098006    # 15
      - 19.109257071294042    # 16
      - 13.512285258549001    # 17
      - 9.55462853564702      # 18
      - 6.7561426292745       # 19
      - 4.77731426782351      # 20
      - 3.3780713146372494    # 21
      - 2.3886571339117544    # 22
      - 1.6890356573186245    # 23
      - 1.1943285669558772    # 24
      - 0.8445178286593122    # 25
      - 0.5971642834779384    # 26
      - 0.422258914329656     # 27
      - 0.29858214173896913   # 28
      - 0.21112945716482798   # 29
      - 0.14929107086948457   # 30
      - 0.1055647285824140000
      - 0.0746455354347420000
      - 0.0527823642912068000
      - 0.0373227677173710000
      - 0.0263911821456034000
      - 0.0186613838586855000
      - 0.0131955910728017000
      - 0.0093306919293427400
      - 0.0065977955364008400
      - 0.0046653459646713700

  webmercator:
    base: GLOBAL_WEBMERCATOR

globals:
  cache:
    base_dir: /opt/var/mapproxy/
    meta_size: [6, 6]
    meta_buffer: 150

  image:
    resampling_method: bicubic
    paletted: false
#    formats:
#      image/png:
#        #colors: 0
#        encoding_options:
#          # quantizer: fastoctree
#          quantizer: mediancut

  tiles:
    expires_hours: 8
